<script>
    
    function onVisibilityChange(el, callback) {
        var old_visible;
        return function () {
            var visible = isInViewport(el);
            if (visible != old_visible) {
                old_visible = visible;
                if (typeof callback == 'function') {
                    callback();
                }
            }
        }
    }

    $("#my_works_popup").on('resize scroll', function(){
        $("video").each(function(i, val){
            if($(val).parent().parent().attr("class") == "swiper-wrapper") return;
            
            if(isInViewport(val)){
                val.play();
            }else if(!val.paused){
                val.pause();
            }
        });
    }); 

    var MY_WORKS = {
        /************
         * MOBI
         ************/
        "mobi" : {
            "name" : "MOBI",
            "skills" : ["Android", "PHP", "MySQL"],
            "links" : [
                {"name" : "Github", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Apps/tree/master/mobi"},
                {"name" : "Play Store", "url" : "https://play.google.com/store/apps/details?id=com.ha.mobi"},
            ],
            "preview" : [
                {"type" : "video", "src" : "./images/mobi/mobi.mp4", "poster" : "./images/mobi/intro.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/login.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/main.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/sp.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/bbs.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/regular.jpg"},
                {"type" : "mobile", "src" : "./images/mobi/setting.jpg"},
            ],
            "description" : "게임 사전등록 & 게임 쿠폰 서비스를 제공하는 네이티브 앱입니다.<br>"+
                     "전 개발자 최초 개발 후 디자인을 제외한 레이아웃 구성, DB 구성, 서버, 앱 등을 100% 직접 개발하였습니다.",
             "dev" : [
                 {
                     "name" : "잠금화면",
                     "links" : [
                         {"name" : "App Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-App/blob/master/mobi/src/main/java/com/ha/mobi/activity/LockScreenActivity.java"},
                         {"name" : "Server Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/html/mobi_cash.php"},
                     ],
                     "preview" : [
                         {"type" : "video", "src" : "./images/mobi/mobi_lock.mp4", "poster" : "./images/mobi/lock.jpg"}    
                     ],
                     "description" : "포인트 적립 및 게임 관련 정보를 제공하는 잠금화면 기능입니다.<br>"+
                                    "SQLite, Cache를 활용하여 로딩 속도를 최적화 및 네트워크 미연결 상태에도 대응하였습니다.<br>"+
                                    "잠금화면의 View, 동작을 서버에서 유동적으로 변경할 수 있도록 개발하였습니다."
                 },
                 {
                     "name" : "스페셜 쿠폰",
                     "links" : [
                         {"name" : "App Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-App/blob/master/mobi/src/main/java/com/ha/mobi/activity/SpecialDetailActivity.java"},
                         {"name" : "Server Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/html/mobi_srv.php#L4460"},
                     ],
                     "preview" : [
                         {"type" : "mobile", "src" : "./images/mobi/sp.jpg"},
                         {"type" : "mobile", "src" : "./images/mobi/sp_detail.jpg?ver=2"},
                     ],
                     "description" : "특정 미션을 완료 시 쿠폰을 발급받을 수 있는 스페셜 쿠폰 기능입니다."
                 },
                 {
                     "name" : "팝업 푸시",
                     "links" : [
                         {"name" : "App Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-App/blob/master/mobi/src/main/java/com/ha/mobi/activity/PopupPushActivity.java"},
                     ],
                     "preview" : [
                         {"type" : "mobile", "src" : "./images/mobi/popup_push.jpg"},
                         {"type" : "mobile", "src" : "./images/mobi/point_push.jpg"},
                     ],
                     "description" : "사전 예약 참여 유도 및 게임 출시 안내, 보너스 포인트 지급을 위한 팝업 푸시 기능입니다."
                 },
                 
             ],
        },
        
        /************
         * 루팅
         ************/
        "looting" : {
            "name" : "루팅",
            "skills" : ["Android", "PHP", "MySQL"],
            "links" : [
                {"name" : "Github", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Apps/tree/master/looting"},
                {"name" : "Play Store", "url" : "https://play.google.com/store/apps/details?id=com.ha.looting"},
            ],
            "preview" : [
                {"type" : "video", "src" : "./images/looting/looting.mp4", "poster":"./images/looting/intro.jpg"},
                {"type" : "mobile", "src" : "./images/looting/login.jpg"},
                {"type" : "mobile", "src" : "./images/looting/main.jpg"},
                {"type" : "mobile", "src" : "./images/looting/game_detail.jpg"},
                {"type" : "mobile", "src" : "./images/looting/plus.jpg"},
                {"type" : "mobile", "src" : "./images/looting/plus_detail.jpg"},
                {"type" : "mobile", "src" : "./images/looting/shop.jpg"},
                {"type" : "mobile", "src" : "./images/looting/my_coup.jpg"},
                {"type" : "mobile", "src" : "./images/looting/menu.jpg"},
            ],
            "description" : "게임 사전등록 & 게임 쿠폰 서비스를 제공하는 네이티브 앱입니다.<br>"+
                            "디자인을 제외한 레이아웃 구성, DB 구성, 서버, 앱 등을 100% 직접 개발하였습니다.",
             "dev" : [
                 {
                     "name" : "플러스 쿠폰",
                     "links" : [
                         {"name" : "App Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-App/blob/master/looting/src/main/java/com/ha/looting/activity/PlusCouponDetailActivity.java"},
                         {"name" : "Server Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/looting/looting_srv.php#L2456"},
                     ],
                     "preview" : [
                         {"type" : "video", "src":"./images/looting/plus.mp4", "poster" : "./images/looting/plus.jpg"},
                         {"type" : "mobile", "src" : "./images/looting/plus_detail.jpg?ver=1"},
                     ],
                     "description" : "게임을 일정 시간 플레이하면 쿠폰을 발급해주는 플러스 쿠폰 기능입니다.<br>"+
                                    ""
                 },
                 {
                     "name" : "설치 푸시",
                     "links" : [
                         {"name" : "Server Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/looting/looting_srv.php#L2230"},
                     ],
                     "preview" : [
                         {"type" : "video", "src" : "./images/looting/install_push.mp4", "poster" : "./images/looting/intro.jpg"},
                         {"type" : "mobile", "src" : "./images/looting/install_push.jpg"},
                     ],
                     "description" : "사전 예약을 참여한 게임을 설치할 경우 쿠폰을 즉시 복사할 수 있는 Notification을 노출하는 기능입니다."
                 },
             ],
        },
        
        /************
         * ZZI
         ************/
        "zzi" : {
            "name" : "게임을 낚다 - ZZI",
            "skills" : ["Android", "PHP", "MySQL"],
            "links" : [
                {"name" : "Github", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Apps/tree/master/zzi"},
                {"name" : "Play Store", "url" : "https://play.google.com/store/apps/details?id=com.ha.zzi"},
            ],
            "preview" : [
                {"type" : "video", "src" : "./images/zzi/zzi.mp4", "poster":"./images/zzi/intro.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/login.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/main.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/game.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/news.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/reserve.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/reserve_detail.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/bbs.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/cashbook.jpg"},
                {"type" : "mobile", "src" : "./images/zzi/cashbook_coupon.jpg"},
            ],
            "description" : "게임 추천과 게임 가계부 서비스를 제공하는 네이티브 앱입니다.<br>"+
                            "전 개발자 최초 개발 후 디자인을 제외한 레이아웃 구성, DB 구성, 서버, 앱 등을 100% 직접 개발하였습니다.",
             "dev" : [
                 {
                     "name" : "게임 가계부",
                     "links" : [
                         {"name" : "App Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-App/blob/master/zzi/src/main/java/com/ha/zzi/fragment/CashbookFragment.java"},
                         {"name" : "Server Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/zzi/zzi_srv.php#L3385"},
                     ],
                     "preview" : [
                         {"type" : "video", "src":"./images/zzi/cashbook.mp4", "poster" : "./images/zzi/cashbook_coupon.jpg?ver=1"},
                         {"type" : "mobile", "src":"./images/zzi/cashbook.jpg"},
                     ],
                     "description" : "구글 결제 내역을 정리하여 보여주는 게임 가계부 기능입니다.<br>"+
                                    "구글 결제 내역 페이지를 크롤링 후 데이터로 파싱하여 회원에게 정보를 노출합니다."
                 },
                 {
                     "name" : "내 게임",
                     "links" : [
                         {"name" : "Source", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/zzi/zzi_mygame.php"},
                     ],
                     "preview" : [
                         {"type" : "mobile", "src" : "./images/zzi/my_game.jpg"},
                     ],
                     "description" : "현재 설치되어 있는 게임들의 쿠폰을 받을 수 있는 각 서비스로 이동시켜주는 기능입니다.<br>"+
                                    "웹페이지로 구성되어 있습니다."
                 },
             ],
        },
        
        
        /************
         * Event
         ************/
        "event" : {
            "name" : "모바일 이벤트 페이지",
            "skills" : ["Javascript", "CSS", "PHP", "MySQL"],
            "links" : [
                {"name" : "Github", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/tree/master/mobile/mobi/event"},
            ],
            "preview" : [
                {"type" : "video", "src" : "./images/event/egg.mp4", "poster" : "./images/event/egg.jpg"},
                {"type" : "video", "src" : "./images/event/scratch.mp4", "poster" : "./images/event/scratch.jpg"},
                {"type" : "video", "src" : "./images/event/ball.mp4", "poster" : "./images/event/ball.jpg"},
                {"type" : "video", "src" : "./images/event/coin.mp4", "poster" : "./images/event/coin.jpg"},
                {"type" : "video", "src" : "./images/event/spin.mp4", "poster" : "./images/event/spin.jpg"},
                {"type" : "video", "src" : "./images/event/typing.mp4", "poster" : "./images/event/typing.jpg"},
            ],
            "description" : "앱 서비스에서 진행됐었던 이벤트 웹페이지입니다.<br>"+
                            "디자인을 제외한 모든 개발에 대해 100% 참여하였습니다.",
             "dev" : [
                 {
                     "name" : "애니메이션",
                     "links" : [
                         {"name" : "Source1", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/mobi/event/weekly/index.php#L387"},
                         {"name" : "Source2", "url" : "https://github.com/man-ramen-black/Portfolio-Monawa-Web/blob/master/mobile/mobi/event/ball/index.php#L386"},
                     ],
                     "preview" : [
                         {"type" : "video", "src" : "./images/event/coin.mp4", "poster" : "./images/event/coin.jpg"},
                         {"type" : "video", "src" : "./images/event/ball.mp4", "poster" : "./images/event/ball.jpg"},
                     ],
                     "description" : "jQuery Animation, CSS Animation 등을 활용하여 애니메이션을 구현하였습니다.<br>"+
                                    "애니메이션의 속성들을 변수로 통제할 수 있도록 고려하여 개발하였습니다."
                 },
                 {
                     "name" : "게임 플레이",
                     "links" : [
                         {"name" : "Source", "url" : ""},
                     ],
                     "preview" : [
                         {"type" : "video", "src" : "./images/event/egg.mp4", "poster" : "./images/event/egg.jpg"},
                     ],
                     "description" : "Javascript Interface, 접근성을 활용하여, 게임 플레이 시간 감지 기능을 구현하였습니다."
                 },
                 {
                     "name" : "확률 설정",
                     "links" : [
                         {"name" : "Ajax Source", "url" : ""},
                         {"name" : "Admin Source", "url" : ""},
                     ],
                     "preview" : [
                         {"type" : "mobile", "src" : "./images/event/egg.jpg"},
                     ],
                     "description" : "확률에 따라 이벤트 상품을 당첨되게 구현하였습니다.<br>"+
                                     "확률은 관리자들이 통계를 확인하며, 유동적으로 설정할 수 있습니다."
                 },
             ],
        },
    };
    
    function getPreviewHtml(data){
        var html = "";
        switch(data.type){
            case "video" : 
                html += "<video loop poster='"+data.poster+"'><source src='"+data.src+"' type='video/mp4'>이 브라우저에서는 동영상이 지원되지 않습니다.</video>";
                break;
            case "mobile" :
                html += "<img src='"+data.src+"'>";
                break;
            case "pc" : 
                html += "<samp style=\"background-image:url('"+data.src+"')\"></samp>";
                break;
        }
        return html;
    }
    
    (function(){
        var my_work = null;
    
        var hash = replaceAll(location.hash, "#", "");
        if(hash.indexOf("my_work_") != -1){
            my_work = MY_WORKS[hash.replace("my_work_", "")];
        }

        if(!my_work){
            $("#my_work_wrap").hide();
            alert("올바르지 않은 페이지입니다.");
            history.back();
            return;
        }

        $(".header h2").prepend(my_work.name);
        my_work.skills.forEach(function(val){
           $(".header .use_skills").append("<li>"+val+"</li>");
        });
        my_work.links.forEach(function(data){
           $(".header .links").append("<button onclick=\"window.open('"+data.url+"')\">"+data.name+"</button>"); 
        });
        my_work.preview.forEach(function(data){
           $(".section:eq(0) .swiper-wrapper").append("<li>"+getPreviewHtml(data)+"</li>"); 
        });
        $(".description:eq(0)").html(my_work.description); 


        my_work.dev.forEach(function(data){
            var section = $.parseHTML($("#section_template").html());
            $(section).find("h3").prepend(data.name);
            data.links.forEach(function(link){
                $(section).find(".links").append("<button onclick=\"window.open('"+link.url+"')\">"+link.name+"</button>");    
            });
            data.preview.forEach(function(preview){
                $(section).find(".preview").append(getPreviewHtml(preview));
            })
            $(section).find(".description").html(data.description); 
            $("#dev").append(section);
        });
        
    })();
    
    
    
</script>
<div id="my_work_wrap">
    <div class="header">
        <h2><span class="underbar"></span></h2>
        <ul class="use_skills"></ul>
        <div class="links"></div>
        <div class="close" onclick="history.back();"></div>
    </div>

    <div class="section">
        <div class="swiper-container">
            <ul class="swiper-wrapper">
            </ul>
        </div>

        <h3>프로젝트 소개<span class="underbar"></span></h3>
        <div class="description"></div>
    </div>

    <h2 style="margin-bottom:20px">주요 개발<span class="underbar"></span></h2>
    <div id="dev"></div>

    <div id="section_template" style="display:none;">
        <div class="section">
            <h3><span class="underbar"></span></h3>
            <div class="links"></div>
            <div class="preview"></div>
            <div class="description"></div>
        </div>
    </div>
</div>